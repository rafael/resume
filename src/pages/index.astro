---
import PageLayout from '../layouts/BaseLayout.astro'
import Section from '../components/Section.astro'
import Card from '../components/Card.astro'
import ProjectCard from '../components/ProjectCard.astro'
import Label from '../components/Label.astro'
import SkillLayout from '../components/SkillLayout.astro'
import PostPreview from '@/components/blog/PostPreview.astro'

import { getAllPosts, sortMDByDate } from '@/utils'
import { Icon } from 'astro-icon/components'

const languages = ['ruby', 'go', 'scala (long time ago now)']
const frontend: string[] = []
const backend = ['sinatra', 'rails']
const others = ['aws', 'rds', 'mysql', 'vitess']

const MAX_POSTS = 10
const allPosts = await getAllPosts()
const allPostsByDate = sortMDByDate(allPosts).slice(0, MAX_POSTS)
---

<PageLayout meta={{ title: 'Root' }}>
	<div class='flex w-full flex-col gap-y-10'>
		<section class='flex flex-col items-center gap-y-7'>
			<div class='flex flex-col items-center gap-y-4'>
				<h1 class='text-3xl font-bold'>Rafael Chacón</h1>
				<div class='flex flex-wrap justify-center gap-x-7 gap-y-3'>
					<Label title='github' as='a' href='https://www.github.com/rafael' target='_blank'>
						<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' class='h-5 w-5' slot='icon'
							><path
								fill='currentColor'
								d='M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37.0 00-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44.0 0020 4.77 5.07 5.07.0 0019.91 1S18.73.65 16 2.48a13.38 13.38.0 00-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07.0 005 4.77 5.44 5.44.0 003.5 8.55c0 5.42 3.3 6.61 6.44 7A3.37 3.37.0 009 18.13V22'
							></path></svg
						>
					</Label>
					<Label title='New York'>
						<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' class='h-5 w-5' slot='icon'
							><path
								fill='currentColor'
								d='M12.003 11.73q.668 0 1.14-.475q.472-.475.472-1.143t-.475-1.14q-.476-.472-1.143-.472t-1.14.476q-.472.475-.472 1.143t.475 1.14q.476.472 1.143.472M12 19.677q2.82-2.454 4.458-4.991q1.638-2.538 1.638-4.39q0-2.744-1.737-4.53T12 3.981q-2.621 0-4.359 1.785t-1.737 4.53q0 1.852 1.638 4.39q1.639 2.537 4.458 4.99m0 1.343q-3.525-3.117-5.31-5.814q-1.786-2.697-1.786-4.909q0-3.173 2.066-5.234Q9.037 3 12 3t5.03 2.062q2.066 2.061 2.066 5.234q0 2.212-1.785 4.909q-1.786 2.697-5.311 5.814m0-10.904'
							></path></svg
						>
					</Label>
					<Label
						title='Connect on Linkedin'
						as='a'
						href='https://www.linkedin.com/in/rafaelchaconvivas/'
						target='_blank'
					>
						<svg
							xmlns='http://www.w3.org/2000/svg'
							viewBox='0 0 16 16'
							slot='icon'
							class='h-5 w-5 text-foreground/75'
							><path
								fill='currentColor'
								d='M0 1.146C0 .513.526 0 1.175 0h13.65C15.474 0 16 .513 16 1.146v13.708c0 .633-.526 1.146-1.175 1.146H1.175C.526 16 0 15.487 0 14.854zm4.943 12.248V6.169H2.542v7.225zm-1.2-8.212c.837 0 1.358-.554 1.358-1.248c-.015-.709-.52-1.248-1.342-1.248S2.4 3.226 2.4 3.934c0 .694.521 1.248 1.327 1.248zm4.908 8.212V9.359c0-.216.016-.432.08-.586c.173-.431.568-.878 1.232-.878c.869 0 1.216.662 1.216 1.634v3.865h2.401V9.25c0-2.22-1.184-3.252-2.764-3.252c-1.274 0-1.845.7-2.165 1.193v.025h-.016l.016-.025V6.169h-2.4c.03.678 0 7.225 0 7.225z'
							></path></svg
						>
					</Label>
				</div>
			</div>
		</section>

		<Section title='About'>
			<p class='text-muted-foreground'>
				Software Engineer with more than 14 years of experience. I have worked on Infrastructure at
				multiple companies during hyper growth periods. Helped them scale, while also expanding the
				bussiness. More recently, working again in product engineering at Figma.
			</p>
		</Section>
		<!-- {
			allPostsByDate.length > 0 && (
				<Section title='Posts'>
					<ul class='flex flex-col gap-y-2'>
						{allPostsByDate.map((p) => (
							<li class='flex flex-col gap-x-2 sm:flex-row'>
								<PostPreview post={p} />
							</li>
						))}
					</ul>
				</Section>
			)
		} -->

		<Section title='Experience'>
			<Card
				heading='Figma'
				subheading='Software Engineer'
				date='October 2022 - Current'
				iconPath='figma'
				altText='Figma'
				imageClass='h-12 w-auto md:-left-16'
			>
				<ul class='ml-4 list-disc text-muted-foreground'></ul>
			</Card>
			<Card
				heading='Slack Technologies'
				subheading='Staff Software Engineer'
				date='July 2017 - Nov 2022'
				iconPath='slack'
				altText='Slack'
				imageClass='h-12 w-auto md:-left-16'
			>
				<ul class='ml-4 list-disc text-muted-foreground'>
					<li>
						Re-architected Slack’s core online database system and migrated it to Vitess to support
						business rapid growth. Over this period, traffic to the database tier increased by 10x
						over 18 months. Impact of this work is documented in this
						<a
							href='https://slack.engineering/scaling-datastores-at-slack-with-vitess/'
							class='link-style'
							target='_blank'
						>
							blog
						</a>
						post and this

						<a
							href='https://www.youtube.com/watch?v=aTItjMJE17c'
							class='link-style'
							target='_blank'
						>
							talk.
						</a>
					</li>

					<li>
						Lead migration that unified and simplified Slack’s online database platform by migrating
						a fleet of more than a 1000 MySQL clusters into Vitess. The migration was achieved with
						zero downtime and transparently to application developers. Presented this work at
						<a
							href='https://www.youtube.com/watch?v=k51L0xdClGQ'
							class='link-style'
							target='_blank'
						>
							Kube-Con2020.
						</a>
					</li>
					<li>
						Set up the foundations that consolidated Vitess as the canonical database solution at
						Slack. This work was instrumental to keep up with product demands in a scalable and
						reliable way. Some projects that were part of these efforts: enabled product teams to
						use Vitess effectively, built migration frameworks, performed table migrations, enhanced
						Vitess to support Slack needs.
					</li>
					<li>
						Vitess
						<a
							href='https://github.com/vitessio/vitess/blob/main/MAINTAINERS.md'
							class='link-style'
							target='_blank'
							>maintainer
						</a> - Implemented and enhanced multiple
						<a
							href='https://github.com/vitessio/vitess/pulls?q=is:pr+author:rafael+is:closed'
							class='link-style'
							target='_blank'
						>
							features</a
						> in Vitess core components: cluster management, VReplication, query service, topology, etc.
					</li>
				</ul>
			</Card>
			<Card
				heading='MyFitnessPal'
				subheading='Lead Software Engineer'
				date='January 2014 - July 2017'
				imagePath='/src/assets/MyFitnessPal_Logo.png'
				altText='MyFitnessPal'
				imageClass='h-12 w-auto md:-left-16'
			>
				<ul class='ml-4 list-disc text-muted-foreground'>
					<li>
						Lead team that implemented and deployed a consolidated payments platform for both
						MapMyFitness and MyFitnessPal aimed to simplify accounting and revenue metrics tracking.
						At the time, this system handled millions of dollars per year in transactions.
					</li>
					<li>
						Solved engineering growth challenges of a platform that went from 40 Million users to
						100 Million users in one year. The overall success of the app led to the acquisition of
						MyFitnessPal by Under Armour for $475 million.
					</li>
				</ul>
			</Card>
			<Card
				heading='Skyscraper'
				subheading='Lead Software Engineer'
				date='January 2014 - July 2017'
				altText='MyFitnessPal'
			>
				<ul class='ml-4 list-disc text-muted-foreground'>
					<li>
						First engineer and full stack application engineer for a startup generating revenue for
						bloggers.
					</li>
				</ul>
			</Card>
			<Card
				heading='Noomii'
				subheading='Lead Software Engineer'
				date='January 2014 - July 2017'
				altText='MyFitnessPal'
			>
				<ul class='ml-4 list-disc text-muted-foreground'>
					<li>Full stack application engineer for coach directory.</li>
				</ul>
			</Card>
		</Section>

		<Section title='Education'>
			<Card
				heading='Universidad Simón Bolivar'
				subheading='Computer Engineering'
				date='September 2003 - September 2008'
				iconPath='usb'
				altText='Simon Bolivar'
				imageClass='h-12 w-auto md:-left-16'
			/>
			<Card
				heading='Université de Poiters'
				subheading='Masters II in Engineering Media for Education'
				date='September 2009 - July 2011'
				altText='Poitiers'
			/>
		</Section>

		<!-- <Section title='Projects'>
			<div class='flex flex-col gap-y-3 sm:flex-row sm:gap-x-3 sm:gap-y-0'>
				<ProjectCard
					href='https://www.google.com'
					heading='Consectetur'
					subheading='Lorem ipsum dolor sit amet consectetur adipisicing elit.'
					imagePath='/src/assets/coming-soon.png'
					altText='Example'
					class='w-full sm:w-1/2'
				/>
				<ProjectCard
					as='div'
					heading='Coming soon...'
					subheading=''
					imagePath='/src/assets/coming-soon.png'
					altText='Lorem, ipsum dolor sit'
					class='w-full sm:w-1/2'
				/>
			</div>
		</Section> -->

		<Section title='Skills'>
			<SkillLayout title='Languages' skills={languages} />
			<!-- <SkillLayout title='Frontend' skills={frontend} /> -->
			<SkillLayout title='Backend' skills={backend} />
			<!-- <SkillLayout title='Others' skills={others} /> -->
		</Section>
	</div>
</PageLayout>
